'use strict';const fs=require("fs"),path=require("path");console.log("\ud83d\udd27 Final import path and component fixes...");
const findFiles=(a,b=[".ts",".tsx",".js",".jsx"])=>{let d=[];fs.readdirSync(a).forEach(c=>{const e=path.join(a,c),f=fs.statSync(e);f&&f.isDirectory()&&!c.startsWith(".")&&"node_modules"!==c?d=d.concat(findFiles(e,b)):b.some(g=>c.endsWith(g))&&d.push(e)});return d},finalMappings=[{from:"../../components/ProjectForm",to:"../../components/forms/ProjectForm"},{from:"../components/ChartsEvents",to:"../components/data/ChartsEvents"},{from:"../components/layout/ErrorBoundary",to:"../components/layout/ErrorBoundary"},
{from:"./components/layout/ErrorBoundary",to:"./components/layout/ErrorBoundary"},{from:"../lib/api/api",to:"../lib/api"},{from:"../../lib/api/api",to:"../../lib/api"},{from:"../../../lib/api/api",to:"../../../lib/api"},{from:"../../../lib/bibliography-sync",to:"../../../lib/services/bibliography-sync"},{from:"../../lib/utils/bibliography-sync",to:"../../lib/services/bibliography-sync"},{from:"../../../lib/fuzzyData",to:"../../../lib/utils/fuzzyData"},{from:"../lib/utils/fuzzyData",to:"../lib/utils/fuzzyData"},
{from:"../../../lib/geocoding",to:"../../../lib/services/geocoding"},{from:"../../../lib/email",to:"../../../lib/services/email"},{from:"../../contexts/ProjectContext",to:"../contexts/ProjectContext"},{from:"../../hooks/useProjectApi",to:"../hooks/useProjectApi"},{from:"../../types/project",to:"../types/project"},{from:"../../app/lib/validation",to:"../../app/lib/utils/validation"},{from:"../../app/lib/fuzzyData",to:"../../app/lib/utils/fuzzyData"},{from:"../../app/components/BulkEditModal",to:"../../app/components/ui/BulkEditModal"},
{from:"../../app/components/ImportHistory",to:"../../app/components/data/ImportHistory"},{from:"../../app/components/PersonForm",to:"../../app/components/forms/PersonForm"},{from:"../../app/components/ImportPersons",to:"../../app/components/data/ImportPersons"},{from:"../../app/components/ImportEvents",to:"../../app/components/data/ImportEvents"},{from:"../../app/components/LifeEventForm",to:"../../app/components/forms/LifeEventForm"}],fixImportsInFile=a=>{try{let b=fs.readFileSync(a,"utf8"),d=!1;
finalMappings.forEach(c=>{const e=new RegExp(`from\\s+['"]${c.from.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}['"]`,"g");e.test(b)&&(b=b.replace(e,`from '${c.to}'`),d=!0,console.log(`\u2705 Fixed: ${a} - ${c.from} -> ${c.to}`))});d&&fs.writeFileSync(a,b,"utf8")}catch(b){console.error(`\u274c Error processing ${a}:`,b.message)}},fixSpecificIssues=()=>{try{let a=fs.readFileSync("app/api/auth/mendeley/callback/route.ts","utf8");a=a.replace(/prisma\.bibliographySync/g,"prisma.bibliography_syncs");fs.writeFileSync("app/api/auth/mendeley/callback/route.ts",
a,"utf8");console.log("\u2705 Fixed: bibliographySync -> bibliography_syncs in mendeley callback")}catch(a){console.error("\u274c Error fixing bibliographySync:",a.message)}try{let a=fs.readFileSync("app/api/projects/[id]/members/route.ts","utf8");a=a.replace(/users:\s*{/g,"user: {");fs.writeFileSync("app/api/projects/[id]/members/route.ts",a,"utf8");console.log("\u2705 Fixed: users -> user in projects members route")}catch(a){console.error("\u274c Error fixing users -> user:",a.message)}try{let a=
fs.readFileSync("app/api/locations/manage/route.ts","utf8");a=a.replace(/life_events:\s*true,?\s*/g,"");a=a.replace(/lifeEvents:\s*loc\._count\.life_events,?\s*/g,"");a=a.replace(/total:\s*loc\._count\.events\s*\+\s*loc\._count\.life_events\s*\+\s*loc\._count\.birth_persons\s*\+\s*loc\._count\.death_persons/g,"total: loc._count.events + loc._count.birth_persons + loc._count.death_persons");fs.writeFileSync("app/api/locations/manage/route.ts",a,"utf8");console.log("\u2705 Fixed: Removed life_events references from locations/manage/route.ts")}catch(a){console.error("\u274c Error fixing life_events references:",
a.message)}try{let a=fs.readFileSync("app/api/locations/route.ts","utf8");a=a.replace(/prisma\.life_events\.findMany\({[\s\S]*?}\);/g,"");a=a.replace(/prisma\.life_events\.count\({[\s\S]*?}\);/g,"");a=a.replace(/prisma\.life_events\.findFirst\({[\s\S]*?}\);/g,"");a=a.replace(/\.\.\.lifeEventLocations\.map\(le\s*=>\s*le\.location\)\.filter\(Boolean\)/g,"");a=a.replace(/total:\s*eventCount\s*\+\s*lifeEventCount/g,"total: eventCount");fs.writeFileSync("app/api/locations/route.ts",a,"utf8");console.log("\u2705 Fixed: Removed life_events references from locations/route.ts")}catch(a){console.error("\u274c Error fixing life_events references in locations route:",
a.message)}try{let a=fs.readFileSync("app/api/projects/[id]/stats/route.ts","utf8");a=a.replace(/prisma\.life_events\.count\({[\s\S]*?}\);/g,"");a=a.replace(/lifeEventsCount,\s*/g,"");fs.writeFileSync("app/api/projects/[id]/stats/route.ts",a,"utf8");console.log("\u2705 Fixed: Removed life_events references from projects stats route")}catch(a){console.error("\u274c Error fixing life_events references in projects stats:",a.message)}};
try{const a=findFiles("./app");console.log(`\ud83d\udcc1 Found ${a.length} files to process...`);a.forEach(fixImportsInFile);fixSpecificIssues();console.log("\ud83c\udf89 Final fixes complete!");console.log("\ud83d\udccb Next steps:");console.log("   1. Run: npm run type-check");console.log("   2. Run: npm run dev");console.log("   3. Test the application")}catch(a){console.error("\u274c Error during final fixes:",a),process.exit(1)};